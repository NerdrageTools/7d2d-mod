<configs>
	<append xpath="/buffs">
		<!-- enemy buffs -->
		<buff name="buffEnemyTargeting" hidden="true" remove_on_death="true">
			<duration value="0" />
			<stack_type value="ignore" />
			<update_rate value="1" />

			<effect_group name="Buff Target">
				<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" target="selfAOE" range="30" buff="buffPlayerHasBeenNoticed">
					<requirement name="EntityTagCompare" target="other" tags="player" />
					<requirement name="NPCIsAlert" target="self" />
				</triggered_effect>
			</effect_group>
		</buff>
		<buff name="buffPlayerHasBeenNoticed" remove_on_death="true" icon="ui_game_symbol_stealth">
			<stack_type value="ignore" />
			<duration value="5" />
			<display_value value="Noticed!" />
		</buff>

		<!-- mastery buffs -->
		<buff name="buffIsJumping" hidden="true" remove_on_death="true">
			<stack_type value="ignore" />
			<duration value="1" />

			<effect_group name="Gain Jumping XP">
				<requirement name="CVarCompare" cvar="$Mastery_Jumping_Lvl" operation="LT" value="10" />

				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Jumping_XP" operation="add" value="1" />
				<triggered_effect trigger="onSelfBuffRemove" action="AddBuff" target="self" buff="buffLvlJumping" />
			</effect_group>
		</buff>

		<buff name="buffLvlJumping" hidden="true" remove_on_death="true">
			<stack_type value="ignore" />
			<duration value="1" />

			<effect_group name="Level Up Jumping">
				<requirement name="CVarCompare" cvar="$Mastery_Jumping_XP" operation="GTE" value="@$Mastery_Jumping_XPTarget" />

				<triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="Your Mastery of Jumping Has Increased!" />
				<triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="levelup" play_in_head="true" />

				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Jumping_Lvl" operation="add" value="1" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Jumping_XP" operation="set" value="0" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Jumping_XPTarget" operation="set" value="@$Mastery_Jumping_Lvl" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Jumping_XPTarget" operation="multiply" value="100" />

				<!-- -->
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Jumping_Lvl" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Jumping_XP" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Jumping_XPTarget" />
				<!-- -->
			</effect_group>
		</buff>

		<buff name="buffIsRunning" hidden="true" remove_on_death="true">
			<stack_type value="ignore" />
			<duration value="0" /><!-- 0 = infinite -->
			<update_rate value="1" />

			<effect_group name="Gain Running XP">
				<requirement name="CVarCompare" cvar="$Mastery_Running_Lvl" operation="LT" value="10" />

				<triggered_effect trigger="onSelfBuffUpdate" action="ModifyCVar" cvar="$Mastery_Running_XP" operation="add" value="1" tag="running" />
				<triggered_effect trigger="onSelfBuffUpdate" action="RemoveBuff" buff="buffIsRunning">
					<requirement name="!EntityHasMovementTag" tags="running" />
				</triggered_effect>
				
				<triggered_effect trigger="onSelfBuffUpdate" action="AddBuff" target="self" buff="buffLvlRunning">
					<requirement name="CVarCompare" cvar="$Mastery_Running_XP" operation="GTE" value="@$Mastery_Running_XPTarget" />
				</triggered_effect>
			</effect_group>
		</buff>

		<buff name="buffLvlRunning" hidden="true" remove_on_death="true">
			<stack_type value="ignore" />
			<duration value="5" />

			<effect_group name="Level Up Running">
				<requirement name="CVarCompare" cvar="$Mastery_Running_Lvl" operation="LT" value="10" />
				<requirement name="CVarCompare" cvar="$Mastery_Running_XP" operation="GTE" value="@$Mastery_Running_XPTarget" />

				<triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="Your Mastery of Running Has Increased!" />
				<triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="levelup" play_in_head="true" />

				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Running_Lvl" operation="add" value="1" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Running_XP" operation="set" value="0" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Running_XPTarget" operation="set" value="@$Mastery_Running_Lvl" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Running_XPTarget" operation="multiply" value="100" />

				<!-- -->
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Running_Lvl" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Running_XP" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Running_XPTarget" />
				<!-- -->
			</effect_group>
		</buff>

		<buff name="buffLvlSneaking" hidden="true" remove_on_death="true">
			<stack_type value="ignore" />
			<duration value="1" />

			<effect_group name="Level Up Sneaking">
				<requirement name="CVarCompare" cvar="$Mastery_Sneaking_Lvl" operation="LT" value="10" />
				<requirement name="CVarCompare" cvar="$Mastery_Sneaking_XP" operation="GTE" value="@$Mastery_Sneaking_XPTarget" />

				<triggered_effect trigger="onSelfBuffStart" action="ShowToolbeltMessage" message="Your Mastery of Sneaking Has Increased!" />
				<triggered_effect trigger="onSelfBuffStart" action="PlaySound" sound="levelup" play_in_head="true" />

				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Sneaking_Lvl" operation="add" value="1" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Sneaking_XP" operation="set" value="0" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Sneaking_XPTarget" operation="set" value="@$Mastery_Sneaking_Lvl" />
				<triggered_effect trigger="onSelfBuffStart" action="ModifyCVar" cvar="$Mastery_Sneaking_XPTarget" operation="multiply" value="100" />

				<!-- -->
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Sneaking_Lvl" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Sneaking_XP" />
					<triggered_effect trigger="onSelfBuffStart" action="CVarLogValue" cvar="$Mastery_Sneaking_XPTarget" />
				<!-- -->
			</effect_group>
		</buff>
	</append>
</configs>